## Char-RNN의 개념

- Char-RNN은 RNN을 처음 배울 때 가장 많이 사용되는 예제 중 하나로서 하나의 글자Character를 RNN의 입력값으로 받고, RNN은 다음에 올 글자를 예측하는 문제입니다.
- 이를 위해서 RNN의 **타겟 데이터를 인풋 문장에서 한 글자씩 뒤로 민 형태**로 구성하면 됩니다. 예를 들어서 **“HELLO”**라는 문장을 학습시키고 싶을 경우, RNN의 (인풋 데이터, 타겟 데이터) 쌍을 (H, E), (E,L), (L, L), (L,O)로 구성합니다.
- 그림은 Char-RNN을 이용해서 HELLO라는 문장을 학습시키는 예제를 보여줍니다.

<img width="678" alt="스크린샷 2024-12-08 오후 7 46 58" src="https://github.com/user-attachments/assets/007a9b5b-3a87-474e-b463-9197f69ca94d">

- 이때 Char-RNN의 출력값 형태는 학습에 사용하는 전체 문자(단어Vocabulary) 집합에 대한 소프트맥스 출력값이 됩니다. 따라서 영어 문자로만 구성된 데이터셋일 경우, 전체 문자 집합은 알파벳 글자 개수인 26이 될 것입니다.
- 즉, Char-RNN의 출력값은 다음에 올 26개의 알파벳 문자에 대한 확신의 정도를 나타내는 26×1 크기의 행렬이 될 것입니다.
- 그 중에서 argmax로 가장 확률이 높은 글자를 다음에 올 글자로 확정하고 그 글자를 이용해서 또 다음에 올 글자를 예측하는 과정을 반복합니다.
- 셰익스피어의 희곡 \<리처드 3세\>로 Char-RNN을 학습하고 샘플링한 결과 중 일부 발췌하면 그림과 같습니다.

<img width="441" alt="스크린샷 2024-12-08 오후 7 56 00" src="https://github.com/user-attachments/assets/144c628f-c314-471a-9686-b3e76bc7ace3">

- 한눈에 봐도 그럴듯한 텍스트를 생성해낸 모습을 볼 수 있습니다. 희곡은 Char-RNN의 학습 데이터로 널리 사용되는데 **RNN이 학습하는 것은 글자 배열의 패턴**이기 때문입니다.
- 희곡 같은 경우 문장의 첫 부분에 “등장인물:” 형태의 고정된 패턴이 반복해서 등장하기 때문에 Char-RNN의 학습에 적합합니다. 이전 그림 의 \<리처드 3세\> 샘플링 결과를 보면 <리처드 3세>의 실제 등장인물인 First Lord, Shepherd, KING RICHARD III, BENVOLIO, ANGELO 등의 이름을 정확히 생성해낸 모습을 볼 수 있습니다. 하지만 First MuntaSTsa와 같은 이상한 이름을 생성한 경우도 있습니다. 또한 생성한 영어 대사의 경우, 의미론적으로는 말이 안되지만 구조적으로는 그럴듯한 모습을 띄는 것을 알 수 있습니다.
- 이제 다른 학습 데이터로 재밌는 실험을 하나 더 해봅시다. 프로그래밍 언어 또한 언어의 문법에 따라 일정한 패턴으로 코드가 작성되기 때문에 Char-RNN의 학습에 적합합니다.
- 다음 그림은 C언어로 작성된 리눅스 소스 코드를 이용해서 Char-RNN을 학습시킨 후 샘플링한 결과입니다.

- 희곡의 경우와 마찬가지로 의미로는 말이 안되지만 구조적으로는 그럴 듯한 모습을 하는 것을 알 수 있습니다.

<img width="587" alt="스크린샷 2024-12-08 오후 7 58 57" src="https://github.com/user-attachments/assets/6afac174-3efc-4f45-985e-2d74391e4f20">

## Argmax 샘플링

<img width="743" alt="스크린샷 2024-12-08 오후 7 59 51" src="https://github.com/user-attachments/assets/c7ff681d-aba4-4640-96a6-9af1c846621a">

## Categorical Distribution 샘플링

<img width="575" alt="스크린샷 2024-12-08 오후 8 00 09" src="https://github.com/user-attachments/assets/e3af61c8-6e28-4af3-b2d1-99507970287d">
