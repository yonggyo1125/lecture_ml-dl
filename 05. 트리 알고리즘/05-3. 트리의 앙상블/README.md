# 트리의 앙상블

## 키워드로 정리

- **앙상블 학습**
    - 더 좋은 예측 결과를 만들기 위해 여러 개의 모델을 훈련하는 머신러닝 알고리즘을 말합니다.
- **랜덤 포레스트**
    - 대표적인 결정 트리 기반의 앙상블 학습 방법입니다.
    - 부트스트랩 샘플을 사용하고 랜덤하게 일부 특성을 선택하여 트리를 만드는 것이 특징 입니다.
- **엑스트라 트리**
    - 랜덤 포레스트와 비슷하게 결정 트리를 사용하여 앙상블 모델을 만들지만 부트스트랩 샘플을 사용하지 않습니다. 
    - 대신 랜덤하게 노드를 분할해 과대적합을 감소시킵니다.
- **그레디언트 부스팅**
    - 랜덤 포레스트나 엑스트라 트리와 달리 결정 트리를 연속적으로 추가하여 손실 함수를 최소화하는 앙상블 방법입니다. 
    - 훈련 속도가 조금 느리지만 더 좋은 성능을 기대할 수 있습니다. 
    - 그레이디언트 부스팅의 속도를 개선한 것이 **히스토그램 기반 그레디언트 부스팅**이며 안정적인 결과와 높은 성능으로 매우 인기가 높습니다.

## 핵심 패키지와 함수
### scikit-learn
- **RandomForestClassifier**
    - 랜덤 포레스트 분류 클래스입니다.
    - `n_estimiators` 매개변수는 앙상블을 구성할 트리의 개수를 지정합니다. 기본값은 100입니다.
    - `criterion` 매개변수는 불순도를 지정하며 기본값은 지니 불순도를 의미하는 `gini` 이고 `entropy`를 선택하여 엔트로피 불순도를 사용할 수 있습니다.
    - `max_depth`는 트리가 성장할 최대 깊이를 지정합니다. 기본값은 `None`으로 지정하면 리프노드가 순수하거나 `min_samples_split`보다 샘플 개수가 적을 때까지 성장합니다.
    - `min_samples_split`는 노드를 나누기 위한 최소 샘플 개수 입니다. 기본값은 2입니다. 
    - `max_feature` 매개변수는 최적의 분할을 위해 탐색할 특성의 개수를 지정합니다. 기본값은 `auto`로 특성 개수의 제곱근입니다.
    - `bootstrap` 매개변수는 부트스트랩 샘플을 사용할지 지정합니다. 기본값은 `True` 입니다.
    - `oob_score`는 `OOB` 샘플을 사용하여 훈련한 모델을 평가할지 지정합니다. 기본값은 `False` 입니다. 
    - `n_jobs` 매개변수는 병렬 실행에 사용할 `CPU` 코어 수를 지정합니다. 기본값은 1로 하나의 코어를 사용합니다. -1로 지정하면 시스템에 있는 모든 코어를 사용합니다.
- **ExtraTreesClassifier**
    - 엑스트라 트리 분류 클래스입니다.
    - n_estimators, criterion, max_depth, min_samples_split, max_features 매개변수는 랜덤 포레스트와 동일합니다.
    - `bootstrap` 매개변수는 부트스트랩 샘플을 사용할지 지정합니다. 기본값은 `False`입니다. 
    - `oob_score`는 `OOB` 샘플을 사용하여 훈련한 모델을 평가할지 지정합니다. 기본값은 `False` 입니다. 
    - `n_jobs` 매개변수는 병렬 실행에 사용할 CPU 코어 수를 지정합니다. 기본값은 1로 하나의 코어를 사용합니다. -1로 지정하면 시스템에 있는 모든 코어를 사용합니다.
- **GradientBoostingClassifier**
    - 그레이디언트 부스팅 분류 클래스입니다.
    - `loss` 매개변수는 손실 함수를 지정합니다. 기본값은 로지스틱 손실 함수를 의미하는 `deviance`입니다. 
    - `learning_rate` 매개변수는 트리가 앙상블에 기여하는 정도를 조절합니다. 기본값은 0.1 입니다.
    - `n_estimators` 매개변수는 부스팅 단계를 수행하는 트리의 개수입니다. 기본값은 100입니다.
    - `subsample` 매개변수는 사용할 훈련 세트의 샘플 비율을 지정합니다. 기본값은 1.0입니다.
    - `max_depth` 매개변수는 개별 회귀 트리의 최대 깊이입니다. 기본값은 3입니다.
- **HistGradientBoostingClassifier**
    - 히스토그램 기반 그레디언트 부스팅 분류 클래스 입니다.
    - `learning_rate` 매개변수는 학습률 또는 감쇠율이라고 합니다. 기본값은 0.1이며 1.0이면 감쇠가 전혀 없습니다.
    - `max_iter`는 부스팅 단계를 수행하는 트리의 개수입니다. 기본값은 100입니다.
    - `max_bins`는 입력 데이터를 나눌 구간의 개수입니다. 기본값은 255이며 이보다 크게 지정할 수 없습니다. 여기에 1개의 구간이 누락된 값을 위해 추가됩니다.


## 정형 데이터와 비정형 데이터
- **정형 데이터** 
    - 어떤 구조로 되어 있는 데이터
    - 이런 데이터는 CSV나 데이터베이스(Database), 혹은 엑셀(Excel)에 저장하기 쉽습니다.
    - 프로그래머가 다루는 대부분의 데이터가 정형 데이터 입니다.
    - 지금까지 배운 머신러닝 알고리즘은 정형 데이터에 잘 맞습니다.
    - 그 중 정형 데이터를 다루는데 가장 뛰어난 성과를 내는 알고리즘이 **앙상블 학습**(ensemble learning)입니다. 
    - 이 알고리즘은 대부분 결정 트리를 기반으로 만들어져 있습니다. 

- **비정형 데이터**
    - 데이터베이스나 엑셀로 표현하기 어려운 것들
    - 책의 글과 같은 텍스트 데이터, 디지털카메라로 찍은 사진, 핸드폰으로 듣는 디지털 음악 등
    - 비정형 데이터는 규칙성을 찾기 어려워 전통적인 머신러닝 방법으로는 모델을 만들기 까다롭습니다.
    - 신경망 알고리즘의 놀라운 발전 덕분에 사진을 인식하고 텍스트를 이해하는 모델을 만들 수 있습니다.
 
## 랜덤 포레스트
- 앙상플 학습의 대표 주자, 안정적인 성능으로 널리 사용
- 결정 트리를 랜덤하게 만들어 결정 트리(나무)의 **숲**을 만듭니다. 그리고 각 결정 트리의 예측을 사용해 최종 예측을 만듭니다.  