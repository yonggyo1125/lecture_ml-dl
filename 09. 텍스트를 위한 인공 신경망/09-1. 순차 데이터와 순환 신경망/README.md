# 순차 데이터와 순환 신경망

## 키워드 정리

- **순차 데이터** : 텍스트나 시계열 데이터와 같이 순서에 의미가 있는 데이터입니다. 대표적인 순차 데이터로는 글, 대화, 일자별 날씨, 일자별 판매 실적 등을 예로 들 수 있습니다.
- **순환 신경망** : 순차 데이터에 잘 맞는 인공 신경망의 한 종류입니다. 순차 데이터를 처리하기 위해 고안된 순환층을 1개 이상 사용한 신경망을 순환 신경망이라고 부릅니다.
- 순환 신경망에서는 종종 순환층을 **셀**이라고 부릅니다. 일반적인 인공 신경망과 마찬가지로 하나의 셀은 여러 개의 뉴런으로 구성됩니다.
- 순환 신경망에서는 셀의 출력을 특별히 **은닉 상태**라고 부릅니다. 은닉 상태는 다음 층으로 전달될 뿐만 아니라 셀이 다음 타임스텝의 데이터를 처리할 때 재사용됩니다.

## 순차 데이터

- **순차 데이터**<sup>sequential data</sup>는 텍스트나 **시계열 데이터**<sup>time series data</sup>와 같이 순서에 의미가 있는 데이터를 말합니다. 예를 들어 "I am a boy"는 쉽게 이해할 수 있지만 "boy am a I"는 말이 되지 않습니다. 또 일별 온도를 기록한 데이터에서 날짜 순서를 뒤죽박죽 섞는다면 내일의 온도를 쉽게 예상하기 어렵습니다.

![스크린샷 2025-03-18 오후 8 01 03](https://github.com/user-attachments/assets/6a00cd08-736b-4adc-8ea1-be97ea4a5d99)

- 지금까지 우리가 보았던 데이터는 순서와 상관이 없었습니다. 예로 패션 MNIST 데이터로 생각해 보죠. 이 데이터를 신경망 모델에 전달할 때 샘플을 랜덤하게 섞은 후 훈련 세트로 나누었습니다. 즉 샘플의 순서와 전혀 상관이 없었죠. 심지어 골고루 섞는 편이 결과가 더 좋았습니다.
- 이는 딥러닝뿐만 아니라 일반적인 머신러닝 모델에서도 마찬가지입니다. 4장에서 봤던 생선 데이터나 패션 MNIST 데이터는 어떤 샘플이 먼저 주입되어도 모델의 학습에 큰 영향을 미치지 않습니다.

![스크린샷 2025-03-18 오후 8 01 10](https://github.com/user-attachments/assets/d6ba648a-7855-4f82-8f27-cc44f7de760b)

- 이 장에서 사용하는 댓글, 즉 텍스트 데이터는 단어의 순서가 중요한 순차 데이터입니다. 이런 데이터는 순서를 유지하며 신경망에 주입해야 합니다. 단어의 순서를 마구 섞어서 주입하면 안 됩니다.
- 따라서 순차 데이터를 다룰 때는 이전에 입력한 데이터를 기억하는 기능이 필요합니다. 예를 들어 "별로지만 추천해요"에서 "추천해요"가 입력될 때 "별로지만"을 기억하고 있어야 이 댓글을 무조건 긍정적이라고 판단하지 않을 것입니다.

> 시계열 데이터는 일정한 시간 간격으로 기록된 데이터를 말합니다.

- 완전 연결 신경망이나 합성곱 신경망은 이런 기억 장치가 없습니다. 하나의 샘플(또는 하나의 배치)을 사용하여 정방향 계산을 수행하고 나면 그 샘플은 버려지고 다음 샘플을 처리할 떄 재사용하지 않습니다.

![스크린샷 2025-03-18 오후 8 06 40](https://github.com/user-attachments/assets/80746ab8-a292-4878-b799-b6f0f3adc510)

- 이렇게 입력 데이터의 흐름이 앞으로만 전달되는 신경망을 **피드포워드 신경망**<sup>feedforward neural network, FFNN</sup>이라고 합니다. 이전 장에서 배웠던 완전 연결 신경망과 합성곱 신경망이 모두 피드포워드 신경망에 속합니다.

![스크린샷 2025-03-18 오후 8 06 50](https://github.com/user-attachments/assets/a4a06f5b-a224-46ea-afeb-efdcc5d58de7)

- 신경망이 이전에 처리했던 샘플을 다음 샘플을 처리하는데 재사용하기 위해서는 이렇게 데이터의 흐름이 앞으로만 전달되어서는 곤란합니다. 다음 샘플을 위해서 이전 데이터가 신경망 층에 순환될 필요가 있죠. 이런 신경망이 바로 순환 신경망입니다.

## 순환 신경망

- **순환 신경망**<sup>recurrent neural network, RNN</sup>은 일반적인 완전 연결 신경망과 거의 비슷합니다. 완전 연결 신경망에 이전 데이터의 처리 흐름을 순환하는 고리 하나만 추가하면 됩니다. 다음 그림에서 은닉층에 있는 붉은 고리를 눈여겨보세요.
